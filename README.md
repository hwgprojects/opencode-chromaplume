# opencode-peacock-sync

Automatically sync your [VS Code Peacock](https://marketplace.visualstudio.com/items?itemName=johnpapa.vscode-peacock) colors to [OpenCode](https://opencode.ai) themes.

When you open a project in OpenCode that has Peacock colors configured, this plugin reads the color and generates a matching OpenCode theme with your Peacock accent color.

## How It Works

```
Your Project/
├── .vscode/
│   └── settings.json          # Peacock stores color here
├── .opencode/
│   └── themes/
│       └── peacock.json       # Generated by this plugin
└── opencode.json              # Auto-updated with "theme": "peacock"
```

1. **Reads** `peacock.color` or `peacock.remoteColor` from `.vscode/settings.json`
2. **Loads** your base theme (default: `theme-darker`) from `~/.config/opencode/themes/`
3. **Generates** a `peacock.json` theme that inherits your base theme but overrides accent colors
4. **Updates** the project's `opencode.json` to use the `peacock` theme

## Installation

### Option 1: From npm (Recommended)

Add to your `~/.config/opencode/opencode.json`:

```json
{
  "plugin": ["opencode-peacock-sync"]
}
```

### Option 2: Local Installation

Copy the plugin to your global plugin directory:

```bash
mkdir -p ~/.config/opencode/plugin
cp src/index.ts ~/.config/opencode/plugin/peacock-sync.ts
```

## Setup

### 1. Create a Base Theme

The plugin needs a base theme to inherit from. Copy the included `theme-darker.json` or create your own:

```bash
mkdir -p ~/.config/opencode/themes
cp themes/theme-darker.json ~/.config/opencode/themes/
```

The base theme should follow [OpenCode's theme format](https://opencode.ai/docs/themes).

### 2. Configure Peacock in VS Code

If you haven't already, install [Peacock](https://marketplace.visualstudio.com/items?itemName=johnpapa.vscode-peacock) in VS Code and set a color for your workspace:

1. Open Command Palette (`Cmd+Shift+P` / `Ctrl+Shift+P`)
2. Run `Peacock: Change to a Favorite Color`
3. Select a color

This creates a `.vscode/settings.json` with your Peacock color.

### 3. Open Your Project in OpenCode

```bash
cd your-project
opencode
```

The plugin will automatically:
- Detect the Peacock color
- Generate `.opencode/themes/peacock.json`
- Set `"theme": "peacock"` in your project's `opencode.json`

## What Gets Themed

The plugin overrides these theme properties with your Peacock color:

| Property | Color Used |
|----------|------------|
| `primary` | Peacock color |
| `accent` | Peacock +15% lighter |
| `secondary` | Peacock -15% darker |
| `borderActive` | Peacock color |
| `markdownHeading` | Peacock color |
| `markdownLink` | Peacock color |
| `markdownLinkText` | Peacock +15% lighter |
| `markdownListItem` | Peacock color |

All other colors are inherited from your base theme.

## Configuration

### Changing the Base Theme

By default, the plugin uses `theme-darker` as the base theme. To use a different base theme, modify the `DEFAULT_BASE_THEME` constant in the plugin source:

```typescript
const DEFAULT_BASE_THEME = "your-theme-name"
```

The theme file should exist at `~/.config/opencode/themes/your-theme-name.json`.

## Example

If your Peacock color is `#215732` (green):

**Input:** `.vscode/settings.json`
```json
{
  "peacock.remoteColor": "#215732"
}
```

**Output:** `.opencode/themes/peacock.json`
```json
{
  "$schema": "https://opencode.ai/theme.json",
  "defs": {
    "peacock": "#215732",
    "peacockLight": "#2f7c47",
    "peacockDark": "#143320"
  },
  "theme": {
    "primary": { "dark": "peacock", "light": "peacock" },
    "accent": { "dark": "peacockLight", "light": "peacockLight" },
    "secondary": { "dark": "peacockDark", "light": "peacockDark" },
    "borderActive": { "dark": "peacock", "light": "peacock" },
    ...
  }
}
```

## Included Base Theme

This repo includes `themes/theme-darker.json`, a dark theme based on the [One Dark](https://github.com/mazeaudit/theme) "Theme Darker" variant with:

- Background: `#23272e`
- Text: `#abb2bf`
- Syntax highlighting matching Atom One Dark

## License

MIT
